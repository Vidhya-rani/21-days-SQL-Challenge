Day 10 â€“ CASE Statements & Conditional Categorization
ðŸ“Œ Overview
On Day 10, I practiced how to use CASE expressions in SQL to categorize data, classify staff, create age groups, and build a performance report combining CASE + aggregates.

ðŸ§© Practice Questions & Answers

1ï¸âƒ£ Categorise patients as 'High', 'Medium', or 'Low' satisfaction
SELECT 
    patient_id,
    satisfaction,
    CASE
        WHEN satisfaction >= 85 THEN 'High'
        WHEN satisfaction >= 70 THEN 'Medium'
        ELSE 'Low'
    END AS satisfaction_category
FROM patients;


2ï¸âƒ£ Label staff roles as 'Medical' or 'Support'
SELECT 
    staff_id,
    role,
    CASE
        WHEN role IN ('Doctor', 'Nurse', 'Surgeon', 'Therapist') THEN 'Medical'
        ELSE 'Support'
    END AS role_category
FROM staff;


3ï¸âƒ£ Create age groups for patients (0â€“18, 19â€“40, 41â€“65, 65+)
SELECT 
    patient_id,
    age,
    CASE
        WHEN age BETWEEN 0 AND 18 THEN '0-18 (Child)'
        WHEN age BETWEEN 19 AND 40 THEN '19-40 (Young Adult)'
        WHEN age BETWEEN 41 AND 65 THEN '41-65 (Middle Age)'
        ELSE '65+ (Senior)'
    END AS age_group
FROM patients;


ðŸŽ¯ Daily Challenge â€“ Service Performance Report
Question:
Create a service performance report showing service name, total patients, average satisfaction, and a performance category based on:


Excellent â†’ avg â‰¥ 85


Good â†’ avg â‰¥ 75


Fair â†’ avg â‰¥ 65


Needs Improvement â†’ else


Sort results by average satisfaction (DESC).
âœ” Answer
SELECT 
    s.service,
    COUNT(p.patient_id) AS total_patients,
    ROUND(AVG(p.satisfaction), 2) AS avg_satisfaction,
    CASE
        WHEN AVG(p.satisfaction) >= 85 THEN 'Excellent'
        WHEN AVG(p.satisfaction) >= 75 THEN 'Good'
        WHEN AVG(p.satisfaction) >= 65 THEN 'Fair'
        ELSE 'Needs Improvement'
    END AS performance_category
FROM patients p
JOIN services_weekly s 
    ON p.service = s.service
GROUP BY s.service
ORDER BY avg_satisfaction DESC;


ðŸ“˜ Summary of Learnings


Using CASE for conditional logic


Creating categorized columns


Combining CASE with aggregate functions


Building service-level analytics reports
